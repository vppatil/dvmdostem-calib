#quick and dirty plotting code for looking at drainage effects on soil moisture
#first run = poorly drained drainage type 0
outdir<-'~/Desktop/pest/soilpools_multirunstage'
setwd('/tmp/year-cal-dvmdostem/')
library(rjson)
avg.years=10
jsons=dir(pattern='json')
num.files=length(jsons)
last.jsons=jsons[(num.files-avg.years):num.files]
soil.vars<-c('CarbonDeep','CarbonShallow','CarbonMineralSum','OrganicNitrogenSum','AvailableNitrogenSum')
soil.list=list()
for(i in 1:avg.years)
{
cmtbgc<-fromJSON(file=last.jsons[i])
#soil pools
carbondeep<-cmtbgc$CarbonDeep
carbonshlw<-cmtbgc$CarbonShallow
carbonmin<-cmtbgc$CarbonMineralSum
organicn<-cmtbgc$OrganicNitrogenSum
availn<-cmtbgc$AvailableNitrogenSum
soil.list[[i]]=c(carbondeep,carbonshlw,carbonmin,organicn,availn)
}
library(plyr)
soil.vals<-apply(ldply(soil.list),2,mean)
vars<-c(soil.vars)
pft.for.df<-c(rep("",length(soil.vars)))
vars.numd=paste(vars,pft.for.df,sep='')
vals<-c(soil.vals)
obs.vals<-data.frame(Variable=vars.numd,Value=vals)
setwd(outdir)
obs.vals
soil.vars<-c('CarbonDeep','CarbonShallow','CarbonMinSum',
'OrganicNSum','AvailableNSum')
soil.lines<-paste("l2 @,@ !",soil.vars[1],"!",sep="")
soil.lines<-c(soil.lines,paste("l1 @,@ !",soil.vars[2:length(soil.vars)],"!",sep=""))
firstline="pif @"
file=cbind(c(firstline,soil.lines))
print(file)
write.table(file,"tem_soilpools.ins",row.names=FALSE,col.names=FALSE,quote=FALSE)
source('~/Desktop/pest/soilpools_multirunstage/pest_processing_avgsoil.r')
#quick and dirty plotting code for looking at drainage effects on soil moisture
#first run = poorly drained drainage type 0
outdir<-'~/Desktop/pest/soilpools_multirunstage'
setwd('/tmp/year-cal-dvmdostem/')
library(rjson)
avg.years=10
jsons=dir(pattern='json')
num.files=length(jsons)
last.jsons=jsons[(num.files-avg.years):num.files]
soil.vars<-c('CarbonDeep','CarbonShallow','CarbonMineralSum','OrganicNitrogenSum','AvailableNitrogenSum')
soil.list=list()
for(i in 1:avg.years)
{
cmtbgc<-fromJSON(file=last.jsons[i])
#soil pools
carbondeep<-cmtbgc$CarbonDeep
carbonshlw<-cmtbgc$CarbonShallow
carbonmin<-cmtbgc$CarbonMineralSum
organicn<-cmtbgc$OrganicNitrogenSum
availn<-cmtbgc$AvailableNitrogenSum
soil.list[[i]]=c(carbondeep,carbonshlw,carbonmin,organicn,availn)
}
library(plyr)
soil.vals<-apply(ldply(soil.list),2,mean)
vars<-c(soil.vars)
pft.for.df<-c(rep("",length(soil.vars)))
vars.numd=paste(vars,pft.for.df,sep='')
vals<-c(soil.vals)
obs.vals<-data.frame(Variable=vars.numd,Value=vals)
setwd(outdir)
obs.vals
head(obs.vals)
names(obs.vals)
write.table(obs.vals,'Pest_Output_Avg.txt',row.names=FALSE,quote=FALSE,sep=',')
#first run = poorly drained drainage type 0
outdir<-'~/Desktop/pest/soilpools_multirunstage/'
setwd('/tmp/year-cal-dvmdostem/')
library(rjson)
avg.years=10
jsons=dir(pattern='json')
num.files=length(jsons)
last.jsons=jsons[(num.files-avg.years):num.files]
soil.vars<-c('CarbonDeep','CarbonShallow','CarbonMineralSum','OrganicNitrogenSum','AvailableNitrogenSum')
soil.list=list()
for(i in 1:avg.years)
{
cmtbgc<-fromJSON(file=last.jsons[i])
#soil pools
carbondeep<-cmtbgc$CarbonDeep
carbonshlw<-cmtbgc$CarbonShallow
carbonmin<-cmtbgc$CarbonMineralSum
organicn<-cmtbgc$OrganicNitrogenSum
availn<-cmtbgc$AvailableNitrogenSum
soil.list[[i]]=c(carbondeep,carbonshlw,carbonmin,organicn,availn)
}
soil.list[[1]]
library(plyr)
soil.vals<-apply(ldply(soil.list),2,mean)
vars<-c(soil.vars)
pft.for.df<-c(rep("",length(soil.vars)))
vars.numd=paste(vars,pft.for.df,sep='')
vals<-c(soil.vals)
obs.vals<-data.frame(Variable=vars.numd,Value=vals)
obs.vals
vals
setwd(outdir)
write.table(obs.vals,'Pest_Output_Avg.txt',row.names=FALSE,quote=FALSE,sep=',')
last.jsons
#first run = poorly drained drainage type 0
outdir<-'~/Desktop/pest/soilpools_multirunstage/'
setwd('/tmp/year-cal-dvmdostem/')
library(rjson)
avg.years=10
jsons=dir(pattern='json')
num.files=length(jsons)
last.jsons=jsons[(num.files-avg.years):num.files]
last.jsons
soil.vars<-c('CarbonDeep','CarbonShallow','CarbonMinSum',
'OrganicNSum','AvailableNSum')
soil.lines<-paste("l2 @,@ !",soil.vars[1],"!",sep="")
soil.lines<-c(soil.lines,paste("l1 @,@ !",soil.vars[2:length(soil.vars)],"!",sep=""))
firstline="pif @"
file=cbind(c(firstline,soil.lines))
print(file)
setwd('~/latestdvmdostem/dvm-dos-tem/DATA/YukFlats_Inputs/datacht')
setwd('~/latestdvmdostem/dvm-dos-tem/DATA/YukFlats_Inputs/datacht')
library(ncdf)
dir()
orig<-open.ncdf('climate_original.nc',write=T)
avg=open.ncdf('avgclimate.nc')
orig.nirr=get.var.ncdf(orig,'NIRR')
orig
avg
orig.nirr=get.var.ncdf(orig,'NIRR')
avg.nirr=get.var.ncdf(avg,'NIRR')
head(avg.nirr)
head(orig.nirr)
ts.plot(orig.nirr,rainbow(109))
dim(orig.nirr)
orig.nirr=get.var.ncdf(orig,'NIRR')
avg.nirr=get.var.ncdf(avg,'NIRR')
ts.plot(orig.nirr,col=rainbow(109))
ts.plot(avg.nirr,col=rainbow(109))
ts.plot(orig.nirr,col=rainbow(109))
ts.plot(avg.nirr,col=rainbow(109),add=T)
ts.plot(avg.nirr,add=T)
ts.plot(avg.nirr)
?ts.plot
ts.plot(as.ts(orig.nirr),col=rainbow(109)
ts.plot(as.ts(orig.nirr),col=rainbow(109))
ts.plot(avg.nirr)
ts.plot(as.ts(orig.nirr),col=rainbow(109))
ts.plot(as.ts(avg.nirr),add=T)
ts.plot(as.ts(orig.nirr),col=rainbow(109))
ts.plot(as.ts(avg.nirr),add=T)
avg.nirr[avg.nirr<1]
avg.nirr
avg.nirr[avg.nirr<10]
ts.plot(as.ts(avg.nirr),ylim=c(-1,10))
ts.plot(as.ts(orig.nirr),col=rainbow(109))
ts.plot(as.ts(avg.nirr),ylim=c(-1,10))
avg.nirr
ts.plot(avg.nirr)
ts.plot(as.ts(avg.nirr)))
ts.plot(as.ts(avg.nirr))
ts.plot(as.ts(orig.nirr))
ts.plot(as.ts(avg.nirr),add=T)
ts.plot(as.ts(orig.nirr))
ts.plot(as.ts(avg.nirr),add=T)
ts.plot(as.ts(avg.nirr))
ts.plot(as.ts(avg.nirr),ylim=c(0,140))
ts.plot(as.ts(orig.nirr),add=T)
